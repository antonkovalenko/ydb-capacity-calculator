<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Capacity Calculator</title>
    <link rel="icon" href="https://storage.yandexcloud.net/ydb-site-assets/ydb_icon.svg" type="image/svg+xml">
    <link rel="stylesheet" href="css/ydb-tech.css">
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <header>
        <h1>
            <img src="https://storage.yandexcloud.net/ydb-site-assets/ydb_icon.svg" alt="YDB Logo" class="logo">
            YDB Capacity Calculator
        </h1>
        <p>Calculate the number of servers required for your YDB cluster</p>
    </header>

    <main>
        <!-- Story Toggle -->
        <div class="story-toggle" role="tablist" aria-label="Stories">
            <button id="story1-toggle" class="toggle-button active" role="tab">Capacity Planner</button>
            <button id="story2-toggle" class="toggle-button" role="tab">Provided Capacity</button>
        </div>

        <!-- Optional: hide/show server configuration -->
        <div class="server-config-toggle" style="text-align:center; margin-bottom:12px;">
            <button id="toggle-server-config" class="toggle-button">Hide Server Configuration</button>
        </div>

        <form id="calculator-form">
            <!-- Server Configuration Section -->
            <section class="form-section" id="server-config-section">
                <h2>Server Configuration</h2>

                <div class="subsection">
                    <h3>Compute</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="cores-per-server">Cores per server <span class="required">*</span></label>
                            <input type="number" id="cores-per-server" min="1" step="1" placeholder="e.g. 32" required aria-required="true">
                        </div>
                        <div class="form-group">
                            <label for="ram-per-server">RAM per server (GB) <span class="required">*</span></label>
                            <input type="number" id="ram-per-server" min="1" step="1" placeholder="e.g. 1024" required aria-required="true">
                        </div>
                    </div>
                </div>

                <div class="subsection">
                    <h3>Storage</h3>
                    <div class="storage-grid">
                        <div class="form-group">
                            <label for="nvme-devices-per-server">NVMe devices per server:</label>
                            <input type="number" id="nvme-devices-per-server" min="0" max="16" step="1" value="0" placeholder="0">
                        </div>
                        <div class="form-group">
                            <label for="nvme-device-size">NVMe device size (TB):</label>
                            <input type="number" id="nvme-device-size" min="0" step="0.1" value="0" placeholder="e.g. 1">
                        </div>
                        <div class="form-group">
                            <label for="vdisks-per-nvme-pdisk">VDisks per NVMe PDisk:</label>
                            <input type="number" id="vdisks-per-nvme-pdisk" min="1" max="32" step="1" value="16" title="Typical default 16">
                        </div>

                        <div class="form-group">
                            <label for="hdd-devices-per-server">HDD devices per server:</label>
                            <input type="number" id="hdd-devices-per-server" min="0" max="16" step="1" value="0" placeholder="0">
                        </div>
                        <div class="form-group">
                            <label for="hdd-device-size">HDD device size (TB):</label>
                            <input type="number" id="hdd-device-size" min="0" step="0.1" value="0" placeholder="e.g. 4">
                        </div>
                        <div class="form-group">
                            <label for="vdisks-per-hdd-pdisk">VDisks per HDD PDisk:</label>
                            <input type="number" id="vdisks-per-hdd-pdisk" min="1" max="16" step="1" value="8" title="Typical default 8">
                        </div>
                    </div>
                </div>

            </section>
            <div id="server-config-summary" class="server-summary hidden" aria-live="polite"></div>

            <!-- Story 1: Capacity Requirements Section -->
            <section class="form-section" id="story1-section">
                <h2>Capacity Requirements</h2>

                <div class="subsection">
                    <h3>Storage Requirements</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="nvme-storage-groups">NVMe Storage Groups:</label>
                            <input type="number" id="nvme-storage-groups" min="0" step="1" value="0" placeholder="0">
                        </div>
                        <div class="form-group">
                            <label for="hdd-storage-groups">HDD Storage Groups:</label>
                            <input type="number" id="hdd-storage-groups" min="0" step="1" value="0" placeholder="0">
                        </div>
                    </div>
                </div>

                <div class="subsection">
                    <h3>Compute Requirements</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="database-cores">Database Node Cores:</label>
                            <input type="number" id="database-cores" min="0" step="1" value="0" placeholder="0">
                        </div>
                        <div class="form-group">
                            <label for="database-ram">Database Node RAM (GB):</label>
                            <input type="number" id="database-ram" min="0" step="1" value="0" placeholder="0">
                        </div>
                    </div>
                </div>
            </section>

            <!-- Story 2: Server Count Section -->
            <section class="form-section hidden" id="story2-section">
                <h2>Server Count</h2>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="server-count">Number of Servers:</label>
                        <input type="number" id="server-count" min="1" step="1" value="1">
                    </div>
                </div>
            </section>

            <div style="text-align:center; margin-top:10px;">
                <button type="submit" id="calculate-button" class="calculate-button">Calculate</button>
            </div>
        </form>

        <!-- Capacity Planner Results -->
        <section id="story1-results" class="hidden" aria-live="polite">
            <h2>Calculation Results — Capacity Planner</h2>
            <div class="results-grid">
                <div id="storage-servers-item" class="result-item">
                    <span class="result-label">Servers required by storage groups:</span>
                    <span class="result-value" id="storage-servers-result"></span>
                </div>
                <div id="cores-servers-item" class="result-item">
                    <span class="result-label">Servers required by cores:</span>
                    <span class="result-value" id="cores-servers-result"></span>
                </div>
                <div id="ram-servers-item" class="result-item">
                    <span class="result-label">Servers required by RAM:</span>
                    <span class="result-value" id="ram-servers-result"></span>
                </div>
                <div id="dominant-item" class="result-item">
                    <span class="result-label">Dominant resource:</span>
                    <span class="result-value" id="dominant-resource-result"></span>
                </div>
                <div id="final-item" class="result-item">
                    <span class="result-label">Final server count:</span>
                    <span class="result-value" id="final-servers-result"></span>
                </div>
            </div>
        </section>

        <!-- Provided Capacity Results -->
        <section id="story2-results" class="hidden" aria-live="polite">
            <h2>Calculation Results — Provided Capacity</h2>
            <div class="results-section">
                <h3>Storage Capacity:</h3>
                <div class="results-grid">
                    <div class="result-item">
                        <span class="result-label">NVMe Storage Groups:</span>
                        <span class="result-value" id="nvme-storage-groups-result"></span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">HDD Storage Groups:</span>
                        <span class="result-value" id="hdd-storage-groups-result"></span>s
                    </div>
                </div>
            </div>
            <div class="results-section">
                <h3>Database Capacity:</h3>
                <div class="results-grid">
                    <div class="result-item">
                        <span class="result-label">Database Cores:</span>
                        <span class="result-value" id="database-cores-result"></span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Database RAM (GB):</span>
                        <span class="result-value" id="database-ram-result"></span>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <p>YDB Capacity Calculator &copy; 2025</p>
    </footer>

    <!-- Warning popover (shown when user enters not-recommended values) -->
    <div id="warning-popover-overlay" class="hidden" role="dialog" aria-modal="true" aria-labelledby="warning-popover-title">
        <div id="warning-popover">
            <button id="warning-popover-close" class="toggle-button" aria-label="Close warning">Close</button>
            <h3 id="warning-popover-title">Configuration warning</h3>
            <div id="warning-popover-messages"></div>
            <div style="text-align:center; margin-top:12px;">
                <img id="warning-popover-image" src="images/cthulhu.png" alt="Warning illustration" style="max-width:100%; width:640px; height:auto;">
            </div>
        </div>
    </div>

    <script src="js/core.js"></script>
    <script src="js/calculator.js"></script>
</body>
</html>